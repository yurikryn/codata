<!DOCTYPE html>
<html>
<body>

<script src="codata2010string.txt"></script>
<script src="codata2014string.txt"></script>
<button id="save-button">Save to file</button>
<pre id="view"></pre>
<a id="save" hidden></a>
<script>
"use strict"
const year = 2014; 
const pattern = /^([{\w].*?)(?:\x20{2,})(-?\d[.\d\x20]*?)(?:\x20e(-?\d+))?(?:\x20{2,})(?:\(exact\)|[.0\x20]*([1-9]\d*))(?:\x20e(-?\d+))?(?:\x20{2,})(.*)$/gm;
let codataObject = [];
for(let i = 0; i < 400; i++){
		let res; 
		if(( res = pattern.exec(window["codata" + year + "string"]) ) === null){ break;}
		if((res[5] !== undefined) && (res[5] !== res[3])){alert("Біда при і = " + i); break;}
		
		codataObject[i] = {
			name    : res[1],
			value   : res[2] +
						((res[4] === undefined)? "": "(" + res[4] + ")") + 
						((res[3] === undefined)? "": " \xD7 10<sup>" + res[3] + "</sup>") + 
						((res[6] ===    ""    )? "": " " + res[6].replace(/\^(-?\d+)/g,"<sup>$1</sup>").replace(/_(\w+)/g,"<sub>$1</sub>").replace(/ohm/g,"\u03A9")),
			rel_uns : (res[4] === undefined)? "exact": Math.abs(+res[4] / +(res[2].replace(/[.\x20]/g, ""))) .toExponential(1).replace(/e(\S+)/," \xD7 10<sup>$1</sup>")
			
			}
			
	}
const codataObjectJSON = JSON.stringify(codataObject, null, "\t");
document.getElementById("view").innerHTML = codataObjectJSON;

document.getElementById("save-button").onclick = function(){
		document.getElementById("save").download = "codata" + year + ".json";
		document.getElementById("save").href = "data:application/javascript;charset=utf-8," + encodeURIComponent(codataObjectJSON);
		document.getElementById("save").click();
	}

console.dir(codataObject);

</script>

</body>
</html>